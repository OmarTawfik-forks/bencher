## Бенчмаркинг Diesel

Первый коммит Diesel был сделан [создателем проекта Sage Griffin][github sgrif] 23 августа 2015 года.
Это было всего через три месяца после [выпуска Rust 1.0][rust v1],
поэтому изначально они использовали встроенный [анализатор производительности libtest bench][libtest bench].
Затем, [3 ноября 2020 года][github diesel 2507], они переключились на использование [Criterion][criterion] в качестве анализатора производительности.

Когда Diesel переключился на использование Criterion,
они также начали [сравнивать свои результаты с другими Rust ORM][github diesel bench].
Этот набор сравнительных бенчмарков теперь включает:

- [Diesel][github diesel]
- [SQLx][github sqlx]
- [Rustorm][github rustorm]
- [Quaint][github quaint]
- [Postgres][github postgres]
- [Rusqlite][github rusqlite]
- [Mysql][github mysql]
- [diesel-async][github diesel async]
- [wtx][github wtx]
- [SeaORM][github seaorm]

Только 5 мая 2021 года участник и теперь ведущий мейнтейнер
[Georg Semmler][github weiznich] начал отслеживать результаты бенчмарков Diesel с течением времени.
Он создал [еженочную GitHub Action][github actions diesel metrics] для запуска бенчмарков
и [отдельное репо для метрик][github diesel metrics] для отслеживания результатов бенчмарков.
Из-за шума раннеров GitHub Action, эти результаты используются лишь для отображения общей тенденции крупных изменений.
Также не настроен мониторинг, поэтому мейнтейнеры Diesel должны вручную проверять результаты, чтобы обнаружить регрессию в производительности.

Чтобы получить еще лучшее понимание влияния изменений на производительность,
[20 марта 2022 года][github diesel 3103]
был добавлен бенчмаркинг на основе подсчета инструкций [с использованием `criterion-perf-events`][github criterion perf events].
Поскольку `criterion-perf-events` использует события Linux `perf`, его нельзя запускать в GitHub Actions.
Поэтому эти бенчмарки должны запускаться локально.

[github diesel first commit]: https://github.com/diesel-rs/diesel/commit/b6b65709ae0c4591713d286273afc293f4e36ca1
[github sgrif]: https://github.com/sgrif
[rust v1]: https://blog.rust-lang.org/2015/05/15/Rust-1.0.html
[github diesel 2507]: https://github.com/diesel-rs/diesel/pull/2507
[github diesel bench]: https://github.com/diesel-rs/diesel/tree/master/diesel_bench
[github diesel]: https://github.com/diesel-rs/diesel
[github sqlx]: https://github.com/launchbadge/sqlx
[github rustorm]: https://github.com/ivanceras/rustorm
[github quaint]: https://github.com/prisma/quaint
[github postgres]: https://github.com/sfackler/rust-postgres
[github rusqlite]: https://github.com/rusqlite/rusqlite
[github mysql]: https://github.com/blackbeam/rust-mysql-simple
[github diesel async]: https://github.com/weiznich/diesel_async
[github wtx]: https://github.com/c410-f3r/wtx
[github seaorm]: https://github.com/SeaQL/sea-orm
[github weiznich]: https://github.com/weiznich
[github diesel metrics]: https://github.com/diesel-rs/metrics
[github actions diesel metrics]: https://github.com/diesel-rs/diesel/commit/f585d63ce573259fc848ff2d561fe5e86faadd6e
[github criterion perf events]: https://github.com/jbreitbart/criterion-perf-events
[github diesel 3103]: https://github.com/diesel-rs/diesel/pull/3103

[libtest bench]: /learn/benchmarking/rust/libtest-bench/
[criterion]: /learn/benchmarking/rust/criterion/
