## Diesel性能基准测试

Diesel 的 [第一次提交][github diesel first commit] 是由项目创建者 [Sage Griffin][github sgrif] 在 2015 年 8 月 23 日完成的。 这距离 [Rust 1.0 发布][rust v1] 仅过去三个月，因此他们最初使用了内置的 [libtest bench][libtest bench] 性能测试工具。 然后在 [2020 年 11 月 3 日][github diesel 2507]，他们切换为使用 [Criterion][criterion] 作为他们的性能测试工具。

当 Diesel 切换到使用 Criterion 时，他们还开始 [与其他 Rust 的 ORM 进行性能对比测试][github diesel bench]。 目前这个性能对比套件包括：

- [Diesel][github diesel]
- [SQLx][github sqlx]
- [Rustorm][github rustorm]
- [Quaint][github quaint]
- [Postgres][github postgres]
- [Rusqlite][github rusqlite]
- [Mysql][github mysql]
- [diesel-async][github diesel async]
- [wtx][github wtx]
- [SeaORM][github seaorm]

直到 2021 年 5 月 5 日，贡献者兼现任主要维护者 [Georg Semmler][github weiznich] 才开始追踪 Diesel 的性能基准测试结果。 他创建了 [一个每晚运行的 GitHub Action][github actions diesel metrics] 来运行基准测试，并且另设 [一个独立的指标仓库][github diesel metrics] 来追踪基准测试结果。 由于 GitHub Action 的运行器噪音较大，这些结果仅用来展示大变更的总体趋势。 目前也没有设置监控，因此 Diesel 的维护者必须手动检查结果以发现性能回归。

为了更好地理解变更对性能的影响，[在 2022 年 3 月 20 日][github diesel 3103] 添加了 [基于指令计数的基准测试 `criterion-perf-events`][github criterion perf events]。 由于 `criterion-perf-events` 使用 Linux 的 `perf` 事件，它无法在 GitHub Actions 中运行。因此，这些基准测试必须在本地运行。

[github diesel first commit]: https://github.com/diesel-rs/diesel/commit/b6b65709ae0c4591713d286273afc293f4e36ca1
[github sgrif]: https://github.com/sgrif
[rust v1]: https://blog.rust-lang.org/2015/05/15/Rust-1.0.html
[github diesel 2507]: https://github.com/diesel-rs/diesel/pull/2507
[github diesel bench]: https://github.com/diesel-rs/diesel/tree/master/diesel_bench
[github diesel]: https://github.com/diesel-rs/diesel
[github sqlx]: https://github.com/launchbadge/sqlx
[github rustorm]: https://github.com/ivanceras/rustorm
[github quaint]: https://github.com/prisma/quaint
[github postgres]: https://github.com/sfackler/rust-postgres
[github rusqlite]: https://github.com/rusqlite/rusqlite
[github mysql]: https://github.com/blackbeam/rust-mysql-simple
[github diesel async]: https://github.com/weiznich/diesel_async
[github wtx]: https://github.com/c410-f3r/wtx
[github seaorm]: https://github.com/SeaQL/sea-orm
[github weiznich]: https://github.com/weiznich
[github diesel metrics]: https://github.com/diesel-rs/metrics
[github actions diesel metrics]: https://github.com/diesel-rs/diesel/commit/f585d63ce573259fc848ff2d561fe5e86faadd6e
[github criterion perf events]: https://github.com/jbreitbart/criterion-perf-events
[github diesel 3103]: https://github.com/diesel-rs/diesel/pull/3103

[libtest bench]: /zh/learn/benchmarking/rust/libtest-bench/
[criterion]: /zh/learn/benchmarking/rust/criterion/
