### Бенчмарк Rustls CI
CI Bench - это передовой инструмент для непрерывного бенчмаркинга.
Он запускает один и тот же бенчмарк в двух разных режимах: режиме подсчета инструкций и режиме реального времени.
Это достигается с помощью гениальной пользовательской асинхронной среды выполнения.
В режиме подсчета инструкций ввод/вывод все еще блокируется.
Под капотом задачи просто завершаются за одну итерацию.
Затем, в режиме реального времени, ввод/вывод действительно неблокирующий.
Это позволяет симулировать общие буферы в памяти.
Сервер и клиент опрашиваются по очереди.
Это позволяет CI Bench устранить шум и недетерминированность асинхронной среды выполнения в их бенчмарках.

Rustls решил отслеживать инструкции процессора с использованием [cachegrind][cachegrind].
Это решение было смоделировано на основе [решения для непрерывного бенчмаркинга компилятора Rust][rustc perf].
Подсчеты инструкций предоставляют очень последовательный способ сравнения двух версий одного и того же программного обеспечения.
Это делает его идеальным для непрерывного бенчмаркинга.
Однако, невозможно вывести реальные затраты времени выполнения от увеличения количества инструкций.
Увеличение инструкций на 10% не обязательно приводит к увеличению производительности на 10%.
Но значительное увеличение инструкций, скорее всего, означает, что есть некоторое увеличение производительности.
По этой причине, CI Bench также измеряет время выполнения.

Время выполнения - это то, что действительно важно для проекта Rustls.
Измерение количества инструкций - это просто полезный промежуточный этап.
Бенчмаркинг, основанный на подсчете инструкций, не может различить изменения, которые используют одинаковое количество инструкций,
но приводят к совершенно разной производительности в реальном времени.
Например, новый алгоритм может иметь точно такое же количество инструкций, но работать в два раза медленнее.

[cachegrind]: https://valgrind.org/docs/manual/cg-manual.html
[rustc perf]: https://github.com/rust-lang/rustc-perf